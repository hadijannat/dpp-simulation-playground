INSERT INTO user_stories (epic_id, code, title, acceptance_criteria, applicable_roles, order_index)
VALUES
  (1, 'US-01-01', 'Register account', '["Register account completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (1, 'US-01-02', 'Login with credentials', '["Login with credentials completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (1, 'US-01-03', 'SSO login', '["SSO login completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (1, 'US-01-04', 'Select role', '["Select role completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (1, 'US-01-05', 'Refresh session', '["Refresh session completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (1, 'US-01-06', 'Logout', '["Logout completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (2, 'US-02-01', 'Create DPP shell', '["Create DPP shell completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (2, 'US-02-02', 'Add Digital Nameplate', '["Add Digital Nameplate completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (2, 'US-02-03', 'Add Carbon Footprint', '["Add Carbon Footprint completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (2, 'US-02-04', 'Upload AASX package', '["Upload AASX package completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (2, 'US-02-05', 'Register DPP in registry', '["Register DPP in registry completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (2, 'US-02-06', 'Generate QR code', '["Generate QR code completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (2, 'US-02-07', 'Bulk import DPPs', '["Bulk import DPPs completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 7),
  (2, 'US-02-08', 'Validate IDTA template', '["Validate IDTA template completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 8),
  (3, 'US-03-01', 'Scan QR and retrieve DPP', '["Scan QR and retrieve DPP completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (3, 'US-03-02', 'Search by product identifier', '["Search by product identifier completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (3, 'US-03-03', 'View compliance status', '["View compliance status completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (3, 'US-03-04', 'Export DPP as JSON', '["Export DPP as JSON completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (3, 'US-03-05', 'Read submodel elements', '["Read submodel elements completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (3, 'US-03-06', 'Fetch lifecycle events', '["Fetch lifecycle events completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (3, 'US-03-07', 'Compare versions', '["Compare versions completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 7),
  (3, 'US-03-08', 'Access as regulator', '["Access as regulator completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 8),
  (3, 'US-03-09', 'Offline export', '["Offline export completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 9),
  (4, 'US-04-01', 'Update repair record', '["Update repair record completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (4, 'US-04-02', 'Append inspection result', '["Append inspection result completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (4, 'US-04-03', 'Update carbon footprint', '["Update carbon footprint completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (4, 'US-04-04', 'Add certificate', '["Add certificate completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (4, 'US-04-05', 'View version history', '["View version history completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (4, 'US-04-06', 'Deprecate submodel', '["Deprecate submodel completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (4, 'US-04-07', 'Notify stakeholders', '["Notify stakeholders completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 7),
  (5, 'US-05-01', 'Initiate transfer', '["Initiate transfer completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (5, 'US-05-02', 'Accept transfer', '["Accept transfer completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (5, 'US-05-03', 'Record handover', '["Record handover completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (5, 'US-05-04', 'Delegate access', '["Delegate access completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (5, 'US-05-05', 'Audit transfer history', '["Audit transfer history completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (6, 'US-06-01', 'Mark product end-of-life', '["Mark product end-of-life completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (6, 'US-06-02', 'Provide disassembly instructions', '["Provide disassembly instructions completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (6, 'US-06-03', 'Record recycled materials', '["Record recycled materials completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (6, 'US-06-04', 'Archive DPP', '["Archive DPP completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (6, 'US-06-05', 'Export compliance archive', '["Export compliance archive completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (6, 'US-06-06', 'Deactivate DPP', '["Deactivate DPP completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (7, 'US-07-01', 'Run ESPR check', '["Run ESPR check completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (7, 'US-07-02', 'Run Battery regulation check', '["Run Battery regulation check completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (7, 'US-07-03', 'Generate compliance report', '["Generate compliance report completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (7, 'US-07-04', 'Notify violations', '["Notify violations completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (7, 'US-07-05', 'Audit trail review', '["Audit trail review completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (8, 'US-08-01', 'View KPI dashboard', '["View KPI dashboard completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (8, 'US-08-02', 'Lifecycle visualization', '["Lifecycle visualization completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (8, 'US-08-03', 'Material flow analysis', '["Material flow analysis completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (8, 'US-08-04', 'Access heatmap', '["Access heatmap completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (8, 'US-08-05', 'Export analytics', '["Export analytics completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (9, 'US-09-01', 'Browse EDC catalog', '["Browse EDC catalog completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (9, 'US-09-02', 'Negotiate data contract', '["Negotiate data contract completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (9, 'US-09-03', 'Start data transfer', '["Start data transfer completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (9, 'US-09-04', 'Subscribe to webhook', '["Subscribe to webhook completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4),
  (9, 'US-09-05', 'ERP sync', '["ERP sync completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 5),
  (9, 'US-09-06', 'DCAT export', '["DCAT export completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 6),
  (10, 'US-10-01', 'Verify sourcing', '["Verify sourcing completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 1),
  (10, 'US-10-02', 'Disclose carbon footprint', '["Disclose carbon footprint completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 2),
  (10, 'US-10-03', 'Calculate circularity metrics', '["Calculate circularity metrics completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 3),
  (10, 'US-10-04', 'Publish transparency report', '["Publish transparency report completed"]', '{manufacturer,regulator,consumer,recycler,developer}', 4)
ON CONFLICT (code) DO UPDATE SET
  epic_id = EXCLUDED.epic_id,
  title = EXCLUDED.title,
  acceptance_criteria = EXCLUDED.acceptance_criteria,
  applicable_roles = EXCLUDED.applicable_roles,
  order_index = EXCLUDED.order_index;
